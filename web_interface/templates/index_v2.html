<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Processor Pro | Solar Pop</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Space+Grotesk:wght@500;700&display=swap"
        rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Space Grotesk', 'sans-serif'],
                    },
                    colors: {
                        base: '#FFF8E7',      /* Cosmic Latte */
                        ink: '#2D3436',       /* Void Charcoal */
                        accent: '#FF6B6B',    /* Bittersweet Coral */
                        pop: '#4ECDC4',       /* Medium Turquoise */
                        sun: '#FFE66D',       /* Maize Yellow */
                    },
                    boxShadow: {
                        'retro': '4px 4px 0px 0px #2D3436',
                        'retro-hover': '6px 6px 0px 0px #2D3436',
                        'retro-active': '2px 2px 0px 0px #2D3436',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #FFF8E7;
            color: #2D3436;
        }

        .solar-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            background-color: #FFF8E7;
            overflow: hidden;
        }

        .solar-blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.6;
            animation: blob 15s infinite alternate;
        }

        @keyframes blob {
            0% {
                transform: scale(1) rotate(0deg);
            }

            100% {
                transform: scale(1.1) rotate(5deg);
            }
        }

        .blob-1 {
            top: -10%;
            left: -10%;
            width: 500px;
            height: 500px;
            background: #FF6B6B;
            animation-delay: 0s;
        }

        .blob-2 {
            top: 40%;
            right: -20%;
            width: 400px;
            height: 400px;
            background: #4ECDC4;
            animation-delay: 2s;
        }

        /* Button Standards */
        .btn-retro {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            border: 2px solid #2D3436;
            border-radius: 0.75rem;
            padding: 0.5rem 1rem;
            box-shadow: 4px 4px 0px 0px #2D3436;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .btn-retro:hover {
            transform: translate(-2px, -2px);
            box-shadow: 6px 6px 0px 0px #2D3436;
        }

        .btn-retro:active {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0px 0px #2D3436;
        }

        .btn-primary {
            background-color: #FF6B6B;
            color: white;
        }

        .btn-primary:hover {
            background-color: #ff5252;
        }

        .btn-secondary {
            background-color: white;
            color: #2D3436;
        }

        .btn-secondary:hover {
            background-color: #f8f8f8;
        }

        .btn-tertiary {
            background-color: #FFE66D;
            color: #2D3436;
        }

        .btn-tertiary:hover {
            background-color: #ffd93d;
        }

        .retro-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.5);
            border: 2px solid #2D3436;
            border-radius: 1rem;
            padding: 1rem;
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1rem;
            box-shadow: 4px 4px 0px 0px #2D3436;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            color: #2D3436 !important;
        }

        .retro-input:hover {
            background: rgba(255, 255, 255, 0.8);
        }

        .retro-input:focus {
            outline: none;
            background: white;
            transform: translate(-2px, -2px);
            box-shadow: 6px 6px 0px 0px #FF6B6B;
            border-color: #FF6B6B;
        }

        .retro-input::placeholder {
            color: #999;
            opacity: 1;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: #FF6B6B;
            border: 2px solid #2D3436;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #ff5252;
        }

        /* Smooth animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-enter {
            animation: fadeIn 0.5s ease-out;
        }

        /* Line clamp utility */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            line-clamp: 2;
            overflow: hidden;
        }
    </style>
</head>

<body class="min-h-screen flex flex-col items-center py-10 px-4 selection:bg-accent selection:text-white">

    <div class="solar-bg">
        <div class="solar-blob blob-1"></div>
        <div class="solar-blob blob-2"></div>
    </div>

    <!-- HEADER -->
    <header class="w-full max-w-4xl flex justify-between items-center mb-16">
        <div>
            <h1
                class="font-display font-black text-5xl tracking-tight leading-none group cursor-default hover:scale-105 transition-transform duration-300">
                VIDEO<br><span class="text-accent drop-shadow-lg">PROCESSOR</span>
            </h1>
            <p class="text-xs font-bold text-ink/60 mt-2 tracking-wider">SOLAR POP EDITION</p>
        </div>
        <div class="flex gap-3">
            <button onclick="openPromptsModal()" class="btn-retro btn-tertiary text-sm" title="Editor de Prompts">
                üìù PROMPTS
            </button>
            <button onclick="openSettingsModal()" class="btn-retro btn-secondary text-sm" title="Configura√ß√µes">
                ‚öôÔ∏è CONFIG
            </button>
        </div>
    </header>

    <main class="w-full max-w-4xl space-y-12">

        <!-- INPUT SECTION -->
        <section id="input-zone" class="relative">
            <label class="block font-display font-bold text-2xl mb-6 ml-1 flex items-center gap-2">
                <span class="inline-block w-2 h-8 bg-accent rounded"></span>
                O QUE VAMOS CRIAR?
            </label>

            <div class="relative">
                <textarea id="urls-input" class="retro-input min-h-[150px] resize-y"
                    placeholder="COLE SUAS URLS AQUI OU CARREGUE UM ARQUIVO..."></textarea>

                <!-- Floating Validation -->
                <div id="validation-counter" class="absolute top-4 right-4 hidden">
                    <div
                        class="flex items-center gap-2 px-3 py-1 bg-sun border-2 border-ink rounded-lg shadow-[2px_2px_0px_0px_#2D3436]">
                        <span id="validation-icon"></span>
                        <span id="validation-count" class="font-bold text-sm"></span>
                    </div>
                </div>
            </div>

            <!-- TOOLBAR -->
            <div class="mt-8 space-y-4">
                <!-- Prompt Selector Card -->
                <div class="bg-white/80 backdrop-blur border-2 border-ink rounded-xl p-4 shadow-retro">
                    <div class="flex items-center justify-between gap-4 flex-wrap">
                        <div class="flex items-center gap-3 flex-1 min-w-[250px]">
                            <span class="text-sm font-bold text-ink whitespace-nowrap">üìã MODELO:</span>
                            <select id="prompt-model-select"
                                class="flex-1 px-4 py-2.5 text-sm font-bold border-2 border-ink rounded-lg bg-white hover:bg-base transition-all cursor-pointer shadow-[2px_2px_0px_0px_#2D3436] hover:shadow-[3px_3px_0px_0px_#2D3436] hover:translate-x-[-1px] hover:translate-y-[-1px]">
                                <option value="">‚è≥ Carregando prompts...</option>
                            </select>
                        </div>
                        <div class="flex items-center gap-2">
                            <div id="prompt-validation-indicator" class="flex items-center gap-1"
                                title="Status de valida√ß√£o">
                                <span id="prompt-status-icon"></span>
                            </div>
                            <button onclick="showPromptInfo()"
                                class="w-8 h-8 border-2 border-ink bg-sun hover:bg-accent hover:text-white font-bold rounded-lg flex items-center justify-center text-sm transition-all shadow-[2px_2px_0px_0px_#2D3436] hover:shadow-[3px_3px_0px_0px_#2D3436]"
                                title="Informa√ß√µes sobre o prompt selecionado">
                                ‚ÑπÔ∏è
                            </button>
                        </div>
                    </div>

                    <!-- Informa√ß√µes do Prompt Selecionado -->
                    <div id="prompt-info" class="hidden mt-3 text-sm bg-base/50 border-2 border-ink/20 rounded-lg p-3">
                        <div id="prompt-description" class="text-ink font-medium"></div>
                        <div id="prompt-validation-details" class="mt-2 text-xs text-ink/70"></div>
                    </div>

                    <!-- Aviso de prompt inv√°lido -->
                    <div id="invalid-prompt-warning"
                        class="hidden mt-3 bg-red-100 border-2 border-red-400 text-red-700 px-4 py-2 rounded-lg text-sm font-medium">
                    </div>
                </div>

                <!-- Action Buttons Row -->
                <div class="flex flex-wrap gap-3 justify-between items-center">
                    <!-- File Actions -->
                    <div class="flex flex-wrap gap-2">
                        <input type="file" id="file-upload" class="hidden" accept=".txt,.csv">
                        <button onclick="document.getElementById('file-upload').click()"
                            class="btn-retro btn-tertiary text-sm">
                            üìÇ ARQUIVO
                        </button>
                        <button onclick="pasteFromClipboard()" class="btn-retro btn-secondary text-sm">
                            üìã COLAR
                        </button>
                        <button onclick="clearInput()"
                            class="btn-retro btn-secondary text-sm hover:bg-red-100 hover:text-red-600 hover:border-red-600">
                            üóëÔ∏è LIMPAR
                        </button>

                        <!-- Hidden helpers -->
                        <span id="url-count" class="hidden"></span>
                        <span id="url-validation-badge" class="hidden"></span>
                        <div id="validation-messages" class="hidden"></div>
                    </div>

                    <!-- Process Button -->
                    <div class="flex gap-3">
                        <button id="btn-process" onclick="startProcessing()"
                            class="btn-retro btn-primary text-base px-10 py-3 text-lg shadow-retro-hover">
                            <span id="btn-process-spinner" class="hidden animate-spin mr-2">‚ö°</span>
                            üöÄ PROCESSAR
                        </button>
                        <button id="btn-cancel" onclick="cancelProcessing()"
                            class="btn-retro btn-secondary hidden text-red-500 border-red-500 hover:bg-red-500 hover:text-white">
                            ‚úñÔ∏è CANCELAR
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- PROCESSING SECTION -->
        <section id="progress-card" class="hidden space-y-6">
            <!-- Current Processing -->
            <div id="current-processing" class="border-4 border-ink bg-white rounded-2xl p-8 shadow-retro-hover">
                <div class="flex justify-between items-center mb-6">
                    <div class="flex-1">
                        <h2 class="font-display font-black text-2xl mb-2">üé¨ PROCESSANDO AGORA</h2>
                        <p id="current-url" class="font-mono font-bold text-sm text-ink/70 truncate">
                            INICIALIZANDO...
                        </p>
                    </div>
                    <button id="btn-cancel-current" onclick="cancelProcessing()"
                        class="btn-retro btn-secondary text-red-500 border-red-500 hover:bg-red-500 hover:text-white ml-4">
                        ‚úñÔ∏è CANCELAR
                    </button>
                </div>

                <!-- Progress Bar -->
                <div class="mb-6">
                    <div class="flex justify-between items-center mb-2">
                        <span id="current-step" class="text-sm font-bold text-ink/70">Preparando...</span>
                        <span id="progress-percent" class="font-display font-black text-2xl text-accent">0%</span>
                    </div>
                    <div class="w-full h-6 bg-base border-2 border-ink rounded-full overflow-hidden">
                        <div id="progress-bar"
                            class="h-full bg-pop border-r-2 border-ink transition-all duration-300 w-0">
                        </div>
                    </div>
                </div>

                <!-- Stats Grid -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 border-t-2 border-ink pt-6">
                    <div>
                        <span class="block text-xs font-black text-secondary tracking-widest">TEMPO</span>
                        <span id="elapsed-time" class="block font-mono font-bold text-xl">0s</span>
                    </div>
                    <div id="eta-container">
                        <span class="block text-xs font-black text-secondary tracking-widest">ESTIMATIVA</span>
                        <span id="eta-time" class="block font-mono font-bold text-xl">--</span>
                    </div>

                    <!-- Steps -->
                    <div id="steps-indicator" class="col-span-2 flex items-center justify-between relative px-2">
                        <div class="absolute w-full h-1 bg-ink -z-10"></div>
                        <div id="step-extraction" class="w-4 h-4 bg-white border-2 border-ink rounded-full"></div>
                        <div id="step-transcription" class="w-4 h-4 bg-white border-2 border-ink rounded-full"></div>
                        <div id="step-summary" class="w-4 h-4 bg-white border-2 border-ink rounded-full"></div>
                        <div id="step-report" class="w-4 h-4 bg-white border-2 border-ink rounded-full"></div>
                    </div>
                </div>

                <!-- Logs -->
                <div id="logs-card" class="hidden mt-8">
                    <button onclick="toggleLogs()"
                        class="text-xs font-bold font-mono border-2 border-ink px-2 py-1 bg-base hover:bg-accent hover:text-white transition-colors">
                        TERMINAL >_
                    </button>
                    <div id="logs-content"
                        class="hidden mt-2 bg-ink p-4 border-2 border-ink text-pop font-mono text-xs h-40 overflow-y-auto">
                        <div id="logs-list"></div>
                    </div>
                </div>
            </div>

            <!-- Queue Display -->
            <div id="queue-display" class="border-4 border-ink bg-white rounded-2xl p-6 shadow-retro">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-display font-black text-xl">üìã FILA DE PROCESSAMENTO</h3>
                    <span id="queue-count" class="px-3 py-1 bg-sun border-2 border-ink rounded-lg font-bold text-sm">
                        0 na fila
                    </span>
                </div>
                <div id="queue-list" class="space-y-2">
                    <p class="text-sm text-ink/50 text-center py-4">Nenhum v√≠deo na fila</p>
                </div>
            </div>

            <div id="status-badge" class="hidden"></div> <!-- Hidden logic container -->
        </section>

        <!-- EXTENSION MANIFESTS SECTION -->
        <section id="extension-manifests-section" class="hidden">
            <div class="bg-white border-2 border-ink rounded-xl p-6 shadow-retro">
                <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-3 mb-4">
                    <h3 class="font-display font-bold text-lg">
                        üîó Manifests Capturados (Extens√£o)
                    </h3>
                    <div class="flex flex-wrap items-center gap-2">
                        <!-- Dropdown de Limpeza -->
                        <div class="relative inline-block">
                            <button onclick="toggleCleanupDropdown()"
                                class="btn-retro btn-secondary text-xs flex items-center gap-1"
                                id="cleanup-dropdown-btn">
                                üóëÔ∏è LIMPAR
                                <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                                    <path d="M6 8L2 4h8z" />
                                </svg>
                            </button>
                            <div id="cleanup-dropdown"
                                class="hidden absolute right-0 mt-2 w-64 bg-white border-2 border-ink rounded-lg shadow-retro z-50">
                                <div class="p-3">
                                    <div class="text-xs font-bold text-ink mb-2">Limpar manifests:</div>

                                    <!-- Op√ß√£o por horas -->
                                    <div class="flex items-center gap-2 mb-3 p-2 hover:bg-base rounded">
                                        <input type="number" id="cleanup-hours" value="24" min="1" max="720"
                                            class="w-16 px-2 py-1 text-xs font-bold border-2 border-ink rounded bg-white text-center">
                                        <span class="text-xs text-ink">horas</span>
                                        <button onclick="cleanupManifests(); toggleCleanupDropdown();"
                                            class="btn-retro btn-tertiary text-xs px-2 py-1 ml-auto">
                                            Limpar
                                        </button>
                                    </div>

                                    <!-- Separador -->
                                    <div class="border-t-2 border-ink/10 my-2"></div>

                                    <!-- Op√ß√£o limpar tudo -->
                                    <button onclick="cleanupAllManifests();"
                                        class="w-full text-left px-2 py-2 text-xs font-bold text-red-600 hover:bg-red-50 rounded flex items-center gap-2">
                                        <span>üóëÔ∏è</span>
                                        <span>Limpar TUDO (irrevers√≠vel)</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <button onclick="refreshManifests()" class="btn-retro btn-secondary text-xs">
                            üîÑ ATUALIZAR
                        </button>
                    </div>
                </div>
                <div id="manifests-list" class="space-y-3">
                    <p class="text-sm text-gray-500">Carregando...</p>
                </div>
            </div>
        </section>

        <!-- LIBRARY SECTION -->
        <section class="animate-enter delay-2">
            <div class="flex justify-between items-center mb-8">
                <h2
                    class="font-display font-black text-3xl bg-sun px-4 py-2 transform -rotate-1 border-2 border-ink shadow-[3px_3px_0px_0px_#2D3436] hover:shadow-retro-hover hover:-rotate-2 transition-all">
                    üìö BIBLIOTECA</h2>
                <input type="text" id="search-reports" placeholder="üîç BUSCAR..."
                    class="retro-input p-3 text-sm w-56 border-2">
            </div>

            <div id="reports-list" class="grid gap-4"></div>
        </section>

    </main>

    <!-- Modals & Toasts -->
    <div id="whats-new-modal" class="fixed inset-0 bg-ink/90 hidden items-center justify-center z-50">
        <div class="bg-base border-4 border-ink rounded-xl p-8 max-w-md w-full shadow-retro relative">
            <div
                class="absolute -top-4 -right-4 bg-accent text-white font-black px-4 py-2 border-2 border-ink transform rotate-3">
                V2.1</div>
            <h2 class="font-display font-black text-3xl mb-4">SOLAR POP V2.1</h2>
            <p class="font-medium mb-6">Visual novo, padronizado e com as fun√ß√µes que voc√™ sentiu falta.</p>
            <button onclick="closeWhatsNew()" class="btn-retro btn-primary w-full justify-center">ENTENDI!</button>
        </div>
    </div>

    <!-- Model Info Modal -->
    <div id="model-info-modal" class="fixed inset-0 bg-ink/90 hidden items-center justify-center z-50">
        <div
            class="bg-base border-4 border-ink rounded-xl p-8 max-w-2xl w-full shadow-retro relative max-h-[90vh] overflow-y-auto">
            <button onclick="closeModelInfo()"
                class="absolute top-4 right-4 w-8 h-8 border-2 border-ink bg-white hover:bg-red-500 hover:text-white font-bold rounded flex items-center justify-center">
                X
            </button>

            <h2 class="font-display font-black text-3xl mb-6">MODELOS DE PROMPT</h2>

            <div class="space-y-6">
                <!-- Modelo 2 -->
                <div class="bg-white border-2 border-ink rounded-xl p-6 shadow-retro">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="text-3xl">üìä</span>
                        <div>
                            <h3 class="font-display font-bold text-xl">MODELO 2 (Padr√£o)</h3>
                            <p class="text-sm text-gray-600">Equilibrado e eficiente</p>
                        </div>
                    </div>
                    <div class="space-y-2 text-sm">
                        <p><strong>‚úÖ Velocidade:</strong> R√°pida</p>
                        <p><strong>‚úÖ Custo:</strong> Baseline (econ√¥mico)</p>
                        <p><strong>‚úÖ Temperature:</strong> 0.3</p>
                        <p><strong>‚úÖ Uso recomendado:</strong> V√≠deos educacionais gerais, processamento em lote</p>
                    </div>
                </div>

                <!-- Modelo 4 -->
                <div class="bg-white border-2 border-ink rounded-xl p-6 shadow-retro">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="text-3xl">üéØ</span>
                        <div>
                            <h3 class="font-display font-bold text-xl">MODELO 4 (H√≠brido)</h3>
                            <p class="text-sm text-gray-600">Otimizado com framework P.R.O.M.P.T.</p>
                        </div>
                    </div>
                    <div class="space-y-2 text-sm">
                        <p><strong>‚úÖ Precis√£o:</strong> M√°xima</p>
                        <p><strong>‚úÖ Temperature:</strong> 0.0 (zero criatividade)</p>
                        <p><strong>‚úÖ Recursos:</strong> Protocolo de conflito + Self-consistency</p>
                        <p><strong>‚úÖ Uso recomendado:</strong> Conte√∫do t√©cnico/cient√≠fico, documenta√ß√£o cr√≠tica</p>
                    </div>
                </div>

                <!-- Compara√ß√£o -->
                <div class="bg-sun border-2 border-ink rounded-xl p-4">
                    <h4 class="font-bold mb-2">üìå Quando usar cada um?</h4>
                    <ul class="text-sm space-y-1">
                        <li><strong>Modelo 2:</strong> Processamento r√°pido, custo menor, v√≠deos gerais</li>
                        <li><strong>Modelo 4:</strong> Precis√£o m√°xima, v√≠deos complexos, valida√ß√£o rigorosa</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div id="report-modal" class="fixed inset-0 bg-ink/90 hidden items-center justify-center z-50">
        <div class="bg-white border-4 border-ink rounded-xl w-full max-w-6xl h-[90vh] flex flex-col shadow-retro">
            <div class="p-4 border-b-4 border-ink flex justify-between items-center bg-sun">
                <h3 id="modal-title" class="font-black text-xl">RELAT√ìRIO</h3>
                <button onclick="closeModal()"
                    class="w-8 h-8 border-2 border-ink bg-white hover:bg-red-500 hover:text-white font-bold rounded flex items-center justify-center">X</button>
            </div>
            <iframe id="report-iframe" class="flex-1 w-full border-none"></iframe>
        </div>
    </div>

    <div id="toast-container" class="fixed bottom-8 right-8 z-[9999] flex flex-col gap-3"></div>

    <!-- MODAL DE CONFIGURA√á√ïES -->
    <div id="settings-modal" class="fixed inset-0 bg-ink/90 hidden items-center justify-center z-50">
        <div class="bg-base border-4 border-ink rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-retro">
            <div class="p-4 border-b-4 border-ink flex justify-between items-center bg-sun sticky top-0">
                <h3 class="font-display font-black text-xl">‚öôÔ∏è CONFIGURA√á√ïES</h3>
                <button onclick="closeSettingsModal()"
                    class="w-8 h-8 border-2 border-ink bg-white hover:bg-red-500 hover:text-white font-bold rounded flex items-center justify-center">X</button>
            </div>

            <div class="p-6 space-y-6">
                <!-- Se√ß√£o: Autentica√ß√£o -->
                <div class="mb-2">
                    <h3 class="font-display font-black text-base text-gray-600 uppercase tracking-wide">üîí Autentica√ß√£o
                    </h3>
                    <p class="text-xs text-gray-400 mt-1">Configure as credenciais para acessar plataformas de cursos e
                        APIs de IA</p>
                </div>

                <!-- Credenciais por Dom√≠nio -->
                <div class="bg-white border-2 border-ink rounded-xl p-4 shadow-retro">
                    <div class="flex justify-between items-center mb-2">
                        <h4 class="font-display font-bold text-lg">üîê CREDENCIAIS POR DOM√çNIO</h4>
                        <button onclick="addCredential()" class="btn-retro btn-tertiary text-xs px-2 py-1">
                            ‚ûï Adicionar
                        </button>
                    </div>
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4 text-xs text-blue-700">
                        üí° <strong>Para que serve:</strong> Login autom√°tico em plataformas de cursos (Hub.la, Hotmart,
                        etc) para acessar v√≠deos protegidos por autentica√ß√£o.
                    </div>
                    <div id="credentials-list" class="space-y-3">
                        <!-- Lista din√¢mica de credenciais -->
                    </div>
                </div>

                <!-- API Keys -->
                <div class="bg-white border-2 border-ink rounded-xl p-4 shadow-retro">
                    <h4 class="font-display font-bold text-lg mb-2">üîë CHAVES DE API</h4>
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4 text-xs text-blue-700">
                        üí° <strong>Para que serve:</strong> Autentica√ß√£o com servi√ßos de IA que geram os resumos dos
                        v√≠deos. Obtenha sua chave em <a href="https://aistudio.google.com/apikey" target="_blank"
                            class="underline font-bold">Google AI Studio</a>.
                    </div>
                    <div class="space-y-4">
                        <div>
                            <label class="block font-bold text-sm mb-1">GEMINI API KEY</label>
                            <p class="text-xs text-gray-500 mb-2">Chave da API do Google Gemini - principal IA usada
                                para gerar resumos</p>
                            <div class="flex gap-2">
                                <input type="password" id="cfg-gemini-key" class="retro-input flex-1 p-2"
                                    placeholder="AIzaSy...">
                                <button onclick="testGeminiApi()" class="btn-retro btn-tertiary text-sm">TESTAR</button>
                            </div>
                            <div id="cfg-gemini-status" class="text-sm mt-2"></div>
                        </div>
                        <div>
                            <label class="block font-bold text-sm mb-1">OPENROUTER API KEY <span
                                    class="font-normal text-gray-500">(opcional)</span></label>
                            <p class="text-xs text-gray-500 mb-2">Alternativa ao Gemini - usado como fallback ou
                                provedor principal se preferir</p>
                            <div class="flex gap-2">
                                <input type="password" id="cfg-openrouter-key" class="retro-input flex-1 p-2"
                                    placeholder="sk-or-v1-...">
                                <button onclick="testOpenRouterApi()"
                                    class="btn-retro btn-tertiary text-sm">TESTAR</button>
                            </div>
                            <div id="cfg-openrouter-status" class="text-sm mt-2"></div>
                        </div>
                    </div>
                </div>

                <!-- Se√ß√£o: Processamento -->
                <div class="mb-2 mt-8">
                    <h3 class="font-display font-black text-base text-gray-600 uppercase tracking-wide">ü§ñ Processamento
                    </h3>
                    <p class="text-xs text-gray-400 mt-1">Configure como o √°udio √© transcrito e os resumos s√£o gerados
                    </p>
                </div>

                <!-- Modelo IA -->
                <div class="bg-white border-2 border-ink rounded-xl p-4 shadow-retro">
                    <h4 class="font-display font-bold text-lg mb-2">‚ö° PROVEDOR DE IA</h4>
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4 text-xs text-blue-700">
                        üí° <strong>Para que serve:</strong> Define qual servi√ßo de IA ir√° processar a transcri√ß√£o e
                        gerar o resumo do v√≠deo.
                    </div>
                    <div class="space-y-4">
                        <div>
                            <label class="block font-bold text-sm mb-1">PROVEDOR PRINCIPAL</label>
                            <p class="text-xs text-gray-500 mb-2">Gemini √© mais r√°pido e recomendado ‚Ä¢ OpenRouter
                                oferece mais op√ß√µes de modelos</p>
                            <select id="cfg-ia-provider" class="retro-input p-2">
                                <option value="gemini">Gemini (Recomendado)</option>
                                <option value="openrouter">OpenRouter</option>
                                <option value="auto">Autom√°tico (fallback)</option>
                            </select>
                        </div>
                        <div class="flex items-center gap-3 bg-amber-50 p-3 rounded-lg border-2 border-amber-300">
                            <input type="checkbox" id="cfg-fallback" class="w-5 h-5" checked>
                            <div>
                                <label for="cfg-fallback" class="font-bold text-sm">Usar fallback autom√°tico</label>
                                <p class="text-xs text-gray-600">Se o provedor principal falhar, tenta automaticamente o
                                    outro</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modelo de Prompt -->
                <div class="bg-white border-2 border-ink rounded-xl p-4 shadow-retro">
                    <h4 class="font-display font-bold text-lg mb-2">üìù TEMPLATE DE RESUMO</h4>
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4 text-xs text-blue-700">
                        üí° <strong>Para que serve:</strong> Define o formato e estilo do resumo gerado. Cada modelo
                        produz um tipo diferente de sa√≠da (notas de estudo, resumo executivo, etc).
                    </div>
                    <div>
                        <label class="block font-bold text-sm mb-1">MODELO DE PROMPT</label>
                        <p class="text-xs text-gray-500 mb-2">Templates dispon√≠veis na pasta modelos_prompts/ do projeto
                        </p>
                        <select id="cfg-prompt-model" class="retro-input p-2">
                            <option value="">Carregando prompts...</option>
                        </select>
                        <!-- Status do prompt selecionado -->
                        <div id="cfg-prompt-status"></div>
                    </div>
                </div>

                <!-- Whisper (IA para Transcri√ß√£o) -->
                <div class="bg-white border-2 border-ink rounded-xl p-4 shadow-retro">
                    <h4 class="font-display font-bold text-lg mb-2">üéôÔ∏è WHISPER (Transcri√ß√£o por IA)</h4>
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4 text-xs text-blue-700">
                        üí° <strong>Para que serve:</strong> Converte o √°udio do v√≠deo em texto. Whisper √© a IA da OpenAI
                        especializada em transcri√ß√£o de √°udio.
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="flex flex-col">
                            <label class="block font-bold text-sm mb-1">MODELO</label>
                            <p class="text-xs text-gray-500 mb-2 min-h-[32px]">Maior modelo = melhor qualidade, mas mais
                                lento</p>
                            <select id="cfg-whisper-model" class="retro-input p-2 mt-auto">
                                <option value="small">Small (500MB) - R√°pido</option>
                                <option value="medium">Medium (1.5GB) - Balanceado</option>
                                <option value="large-v3">Large V3 (3GB) - Mais preciso</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label class="block font-bold text-sm mb-1">DISPOSITIVO</label>
                            <p class="text-xs text-gray-500 mb-2 min-h-[32px]">GPU √© muito mais r√°pido se dispon√≠vel</p>
                            <select id="cfg-whisper-device" class="retro-input p-2 mt-auto">
                                <option value="cpu">CPU (Compat√≠vel com todos)</option>
                                <option value="cuda">GPU NVIDIA (CUDA) - 10x mais r√°pido</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Se√ß√£o: Sistema -->
                <div class="mb-2 mt-8">
                    <h3 class="font-display font-black text-base text-gray-600 uppercase tracking-wide">üíæ Sistema</h3>
                    <p class="text-xs text-gray-400 mt-1">Configura√ß√µes de armazenamento e cache</p>
                </div>

                <!-- Armazenamento e Cache -->
                <div class="bg-white border-2 border-ink rounded-xl p-4 shadow-retro">
                    <h4 class="font-display font-bold text-lg mb-2">üìÅ ARMAZENAMENTO E CACHE</h4>
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4 text-xs text-blue-700">
                        üí° <strong>Para que serve:</strong> Define onde os relat√≥rios s√£o salvos e por quanto tempo os
                        dados ficam em cache.
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="flex flex-col">
                            <label class="block font-bold text-sm mb-1">PASTA DE SUM√ÅRIOS</label>
                            <p class="text-xs text-gray-500 mb-2 min-h-[32px]">Diret√≥rio onde os relat√≥rios HTML s√£o
                                salvos</p>
                            <input type="text" id="cfg-sumarios-dir" class="retro-input p-2 mt-auto"
                                placeholder="sumarios">
                        </div>
                        <div class="flex flex-col">
                            <label class="block font-bold text-sm mb-1">CACHE TTL (HORAS)</label>
                            <p class="text-xs text-gray-500 mb-2 min-h-[32px]">Tempo para manter transcri√ß√µes em cache
                                (evita reprocessar)</p>
                            <input type="number" id="cfg-cache-ttl" class="retro-input p-2 mt-auto" placeholder="72"
                                min="1" max="720">
                        </div>
                    </div>
                </div>

                <!-- Bot√£o Salvar -->
                <button onclick="saveConfigSettings()" class="btn-retro btn-primary w-full justify-center text-lg py-3">
                    üíæ SALVAR CONFIGURA√á√ïES
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL DO EDITOR DE PROMPTS -->
    <div id="prompts-modal" class="fixed inset-0 bg-ink/90 hidden items-center justify-center z-50">
        <div
            class="bg-base border-4 border-ink rounded-xl w-full max-w-5xl max-h-[95vh] overflow-hidden shadow-retro flex flex-col">
            <div class="p-4 border-b-4 border-ink flex justify-between items-center bg-pop sticky top-0">
                <h3 class="font-display font-black text-xl">üìù EDITOR DE PROMPTS</h3>
                <button onclick="closePromptsModal()"
                    class="w-8 h-8 border-2 border-ink bg-white hover:bg-red-500 hover:text-white font-bold rounded flex items-center justify-center">X</button>
            </div>

            <div class="flex flex-1 overflow-hidden">
                <!-- Lista de Prompts (Sidebar) -->
                <div class="w-64 border-r-4 border-ink bg-white flex flex-col">
                    <div class="p-3 border-b-2 border-ink bg-gray-50">
                        <button onclick="createNewPrompt()" class="btn-retro btn-primary w-full text-sm py-2">
                            ‚ûï NOVO PROMPT
                        </button>
                    </div>
                    <div id="prompts-list" class="flex-1 overflow-y-auto p-2 space-y-2">
                        <p class="text-sm text-gray-500 text-center py-4">Carregando...</p>
                    </div>
                </div>

                <!-- Editor -->
                <div class="flex-1 flex flex-col overflow-hidden">
                    <!-- Header do Editor -->
                    <div id="editor-header" class="p-4 border-b-2 border-ink bg-white hidden">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center gap-3">
                                <input type="text" id="prompt-name-input"
                                    class="font-display font-bold text-lg border-2 border-ink rounded px-2 py-1 w-64"
                                    placeholder="Nome do prompt (ex: modelo6)">
                                <button id="validation-info-btn" onclick="openValidationModal()"
                                    class="hidden px-3 py-1.5 border-2 border-red-600 bg-red-500 hover:bg-red-600 text-white font-bold rounded-lg text-xs transition-all hover:scale-105 shadow-md hover:shadow-lg flex items-center gap-1.5 animate-pulse"
                                    title="Clique para ver os erros de valida√ß√£o">
                                    <span class="text-base">‚ö†Ô∏è</span>
                                    <span id="validation-error-text">VER ERROS</span>
                                </button>
                                <span id="validation-success-badge"
                                    class="hidden text-sm text-green-600 font-semibold">‚úÖ V√°lido</span>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="saveCurrentPrompt()" class="btn-retro btn-primary text-sm">
                                    üíæ SALVAR
                                </button>
                                <button onclick="deleteCurrentPrompt()" id="delete-prompt-btn"
                                    class="btn-retro btn-tertiary text-sm hidden">
                                    üóëÔ∏è EXCLUIR
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- √Årea do Editor Markdown -->
                    <div id="editor-container" class="flex-1 overflow-y-auto p-4 bg-white hidden"
                        style="min-height: 0;">
                        <textarea id="prompt-editor"></textarea>
                    </div>

                    <!-- Placeholder quando nada selecionado -->
                    <div id="editor-placeholder" class="flex-1 flex items-center justify-center bg-gray-50">
                        <div class="text-center text-gray-400">
                            <div class="text-6xl mb-4">üìÑ</div>
                            <p class="text-lg">Selecione um prompt para editar</p>
                            <p class="text-sm mt-2">ou crie um novo clicando em "‚ûï NOVO PROMPT"</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Valida√ß√£o -->
    <div id="validation-modal" class="fixed inset-0 bg-ink/90 hidden items-center justify-center z-[9999]">
        <div class="bg-white border-4 border-ink rounded-xl w-full max-w-2xl max-h-[80vh] overflow-y-auto shadow-retro">
            <div class="p-4 border-b-4 border-ink flex justify-between items-center bg-red-100 sticky top-0">
                <h3 class="font-display font-black text-xl text-red-700">‚ö†Ô∏è ERROS DE VALIDA√á√ÉO</h3>
                <button onclick="closeValidationModal()"
                    class="w-8 h-8 border-2 border-ink bg-white hover:bg-red-500 hover:text-white font-bold rounded flex items-center justify-center">X</button>
            </div>
            <div id="validation-modal-content" class="p-6"></div>
        </div>
    </div>

    <!-- EasyMDE CSS e JS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/easymde/dist/easymde.min.css">
    <script src="https://cdn.jsdelivr.net/npm/easymde/dist/easymde.min.js"></script>

    <script src="/static/js/templates.js?v=20251216"></script>
    <script src="/static/js/main_v2.js"></script>
    <script src="/static/js/extension_manifests.js"></script>

    <!-- Extension Manifests Section (injected by JS) -->
    <div id="extension-manifests" class="hidden" style="margin-top: 2rem;">
        <div
            style="background: white; border: 2px solid #2D3436; border-radius: 0.75rem; padding: 1.5rem; box-shadow: 4px 4px 0px 0px #2D3436;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h3 style="font-family: 'Space Grotesk', sans-serif; font-weight: 700; font-size: 1.125rem;">
                    üîó Manifests Capturados (Extens√£o)
                </h3>
                <button onclick="refreshManifests()" class="btn-retro btn-secondary text-xs">
                    üîÑ ATUALIZAR
                </button>
            </div>
            <div id="manifests-list" style="display: flex; flex-direction: column; gap: 0.75rem;">
                <p style="font-size: 0.875rem; color: #666;">Carregando...</p>
            </div>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o de Limpeza -->
    <div id="cleanup-confirm-modal" class="hidden fixed inset-0 bg-ink/50 flex items-center justify-center z-[9999]">
        <div
            class="bg-base border-4 border-ink rounded-xl p-6 shadow-[8px_8px_0px_0px_#2D3436] max-w-md mx-4 animate-enter">
            <div class="flex items-start gap-3 mb-4">
                <div class="text-3xl" id="cleanup-modal-icon">‚ö†Ô∏è</div>
                <div class="flex-1">
                    <h3 class="font-display font-bold text-lg text-ink mb-2" id="cleanup-modal-title">
                        Confirmar Limpeza
                    </h3>
                    <p class="text-sm text-ink" id="cleanup-modal-message">
                        Deseja continuar?
                    </p>
                </div>
            </div>
            <div class="flex gap-3 justify-end">
                <button onclick="closeCleanupModal(false)" class="btn-retro btn-secondary text-xs px-4 py-2">
                    ‚ùå CANCELAR
                </button>
                <button onclick="closeCleanupModal(true)" class="btn-retro btn-primary text-xs px-4 py-2"
                    id="cleanup-confirm-btn">
                    ‚úÖ CONFIRMAR
                </button>
            </div>
        </div>
    </div>

    <style>
        /* Report Cards Injection Style */
        #reports-list>div {
            background: white !important;
            border: 2px solid #2D3436 !important;
            border-radius: 0.75rem !important;
            box-shadow: 4px 4px 0px 0px #2D3436 !important;
            transition: all 0.1s !important;
        }

        #reports-list>div:hover {
            transform: translate(-2px, -2px) !important;
            box-shadow: 6px 6px 0px 0px #FF6B6B !important;
        }

        /* EasyMDE Editor Fixes */
        #editor-container {
            display: flex;
            flex-direction: column;
            overflow: hidden;
            /* Remover scroll do container externo */
        }

        #editor-container .EasyMDEContainer {
            display: flex;
            flex-direction: column;
            flex: 1;
            min-height: 0;
            overflow: hidden;
        }

        #editor-container .editor-toolbar {
            position: sticky;
            top: 0;
            z-index: 10;
            background: #f8f9fa;
            border-bottom: 1px solid #ddd;
            flex-shrink: 0;
        }

        #editor-container .CodeMirror {
            flex: 1;
            min-height: 0;
            height: auto !important;
        }

        #editor-container .CodeMirror-scroll {
            overflow-y: scroll !important;
            overflow-x: scroll !important;
        }

        /* For√ßar barras de rolagem sempre vis√≠veis no editor */
        #editor-container .CodeMirror-scroll::-webkit-scrollbar {
            width: 12px;
            height: 12px;
            display: block;
        }

        #editor-container .CodeMirror-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 6px;
        }

        #editor-container .CodeMirror-scroll::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 6px;
        }

        #editor-container .CodeMirror-scroll::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Firefox */
        #editor-container .CodeMirror-scroll {
            scrollbar-width: auto;
            scrollbar-color: #888 #f1f1f1;
        }

        #editor-container .editor-statusbar {
            flex-shrink: 0;
        }
    </style>

    <!-- JavaScript Files -->
    <script src="{{ url_for('static', filename='js/templates.js') }}?v=20251221ac"></script>
    <script src="{{ url_for('static', filename='js/main_v2.js') }}?v=20251221ac"></script>
    <script src="/static/js/extension_manifests.js?v=20251221ac"></script>
</body>

</html>
```